library(CmmD)
setwd("~/Vascular_Disease/MG-04_Illumina_totalRNASeq")
# Create a vector with the paths where Molti's Output files are saved.
structures_12 <- paste0("molti_out/",seq(0,13,1),".csv")
# Detect community trajectories and tree distances between each gene.
curie_to_12_full <- CmmD_from_community_structures(nodelist = NULL, community_structures = structures_12, resolution_start = 0.5,resolution_end = 13,interval = 0.5,distmethod = "hamming",threads = 7)
curie_to_12_full$hamming_distance_matrix = as.matrix(curie_to_12_full$distance_matrix) * 24 # This transformation is needed because parallel dist is weighted.
curie_to_12_full$hamming_distance_matrix = as.matrix(curie_to_12_full$distance_matrix) * 26 # This transformation is needed because parallel dist is weighted.
View(curie_to_12_full)
# Create a vector with the paths where Molti's Output files are saved.
structures_12 <- paste0("molti_out/",seq(0,50,1),".csv")
# Detect community trajectories and tree distances between each gene.
curie_to_12_full <- CmmD_from_community_structures(nodelist = NULL, community_structures = structures_12, resolution_start = 0,resolution_end = 50,interval = 1,distmethod = "hamming",threads = 7)
write.csv(curie_to_12_full, file="../multilayer/hamming_2022.csv")
curie_to_12_full$hamming_distance_matrix = as.matrix(curie_to_12_full$distance_matrix) * 50 # This transformation is needed because parallel dist is weighted.
write.csv(curie_to_12_full$hamming_distance_matrix, file="../multilayer/hamming_2022.csv")
write.csv(curie_to_12_full$hamming_distance_matrix, file="multilayer/hamming_2022.csv")
ham_dist <- curie_to_12_full$hamming_distance_matrix
ifun <- function(g) {
inx <- c()
for (k in 1:(length(g))) {
inx <- c(inx,which(rownames(ham_dist)==g[k]))
}
return(inx)
}
library(sigclust2)
library(jaccard)
library(AnnotationDbi)
library(org.Hs.eg.db)
library(gprofiler2)
library(dendroextras)
library(dendextend)
library(circlize)
setwd("~/Vascular_Disease/MG-04_Illumina_totalRNASeq/feature_selection")
g.lst <- readRDS("sel_genes_l")
patient_lst <- lapply(g.lst,function(x) as.integer(unique(unlist(g.lst)) %in% x))
patient_matrix <- lapply(patient_lst, function(x) as.data.frame(x))
for (i in 1:length(patient_matrix)) {
rownames(patient_matrix[[i]]) <- unique(unlist(g.lst))
}
patient_matrix <- lapply(patient_matrix, function(x) as.data.frame(x))
patient_matrix <- as.data.frame(patient_matrix)
colnames(patient_matrix) <- c("VM015", "VM024", "VM038", "VM040", "VM042", "VM043",
"VM048", "VM053", "VM054", "VM055", "VM056", "VM060", "VM064",
"VM066", "VM068", "VM071", "VM072", "VM073", "VM081", "VM082",
"VM083", "VM085", "VM089", "VM090", "VM092", "VM093", "VM099",
"VM103", "VM108", "VM110", "VM111", "VM113", "VM119", "VM124",
"VM125", "VM127")
patient_matrix <- t(patient_matrix)
vfun <- function(x, y) {1 - jaccard(x, y)}
mfun <- function(x) {
as.dist(outer(split(x, f = row(x)), split(x, f = row(x)),
Vectorize(vfun)))
}
geneSymbols <- mapIds(org.Hs.eg.db, keys=rownames(t(patient_matrix)), keytype="SYMBOL", column="ENTREZID", multiVals="first")
head(geneSymbols)
inds <- which(!is.na(geneSymbols))
found_genes <- geneSymbols[inds]
g.lst.eid <- lapply(g.lst, function(x) found_genes[x])
saveRDS(g.lst.eid, file="../multilayer/genes_per_patient2")
ham_dist <- curie_to_12_full$hamming_distance_matrix
ifun <- function(g) {
inx <- c()
for (k in 1:(length(g))) {
inx <- c(inx,which(rownames(ham_dist)==g[k]))
}
return(inx)
}
index.lst <- lapply(g.lst.eid, function(x) ifun(x))
#Making a list of the patients' dataframes
df.lst <- lapply(index.lst, function(x) ham_dist[x,x])
cfun <- function(d,n) {
df.filt <- apply(d, 1, function(x) which(x!=24))
}
df.filt.lst <- lapply(df.lst, cfun)
df.filt.lst2 <- df.filt.lst
for (m in 1:length(df.filt.lst2)) {
len <- sapply(df.filt.lst[[m]], length)
df.filt.lst2[[m]] <- df.filt.lst[[m]][order(len)]
if (length(df.filt.lst2[[m]][[1]])==1) {
df.filt.lst2[[m]] <- df.filt.lst2[[m]][-(1)]
}
}
post.mn.patients <- lapply(df.filt.lst2, function(x) names(x))
post.mn.patients.matrix <- lapply(post.mn.patients,function(x) as.integer(unique(unlist(post.mn.patients)) %in% x))
post.mn.patients.matrix <- lapply(post.mn.patients.matrix, function(x) as.data.frame(x))
for (i in 1:length(post.mn.patients.matrix)) {
rownames(post.mn.patients.matrix[[i]]) <- unique(unlist(post.mn.patients))
}
post.mn.patients.matrix <- as.data.frame(post.mn.patients.matrix)
colnames(post.mn.patients.matrix) <- c("VM015", "VM024", "VM038", "VM040", "VM042", "VM043",
"VM048", "VM053", "VM054", "VM055", "VM056", "VM060", "VM064",
"VM066", "VM068", "VM071", "VM072", "VM073", "VM081", "VM082",
"VM083", "VM085", "VM089", "VM090", "VM092", "VM093", "VM099",
"VM103", "VM108", "VM110", "VM111", "VM113", "VM119", "VM124",
"VM125", "VM127")
post.mn.patients.matrix <- t(post.mn.patients.matrix)
saveRDS(df.lst, file="sel_hamming_l2")
saveRDS(post.mn.patients, file="filt_genes_per_patient_l2")
setwd("~/Vascular_Disease/MG-04_Illumina_totalRNASeq/feature_selection")
g.lst <- readRDS("sel_genes_v")
patient_lst <- lapply(g.lst,function(x) as.integer(unique(unlist(g.lst)) %in% x))
patient_matrix <- lapply(patient_lst, function(x) as.data.frame(x))
for (i in 1:length(patient_matrix)) {
rownames(patient_matrix[[i]]) <- unique(unlist(g.lst))
}
patient_matrix <- lapply(patient_matrix, function(x) as.data.frame(x))
patient_matrix <- as.data.frame(patient_matrix)
colnames(patient_matrix) <- c("VM015", "VM024", "VM038", "VM040", "VM042", "VM043",
"VM048", "VM053", "VM054", "VM055", "VM056", "VM060", "VM064",
"VM066", "VM068", "VM071", "VM072", "VM073", "VM081", "VM082",
"VM083", "VM085", "VM089", "VM090", "VM092", "VM093", "VM099",
"VM103", "VM108", "VM110", "VM111", "VM113", "VM119", "VM124",
"VM125", "VM127")
patient_matrix <- t(patient_matrix)
vfun <- function(x, y) {1 - jaccard(x, y)}
mfun <- function(x) {
as.dist(outer(split(x, f = row(x)), split(x, f = row(x)),
Vectorize(vfun)))
}
set.seed(2022)
res_shc <- shc(patient_matrix, matmet=mfun, linkage="ward.D2", n_sim = 1000)
res_shc$hc_dat$labels <- rownames(patient_matrix)
saveRDS(res_shc, "res_shc")
png(file="hc_pre_multi_v.png", width =465, height = 225, units = "mm", res=300)
plot(res_shc,alpha=0.5,ci_emp=T,use_labs = TRUE)
dev.off()
#Mapping gene IDs
geneSymbols <- mapIds(org.Hs.eg.db, keys=rownames(t(patient_matrix)), keytype="SYMBOL", column="ENTREZID", multiVals="first")
head(geneSymbols)
inds <- which(!is.na(geneSymbols))
found_genes <- geneSymbols[inds]
g.lst.eid <- lapply(g.lst, function(x) found_genes[x])
saveRDS(g.lst.eid, file="../multilayer/genes_per_patientv2")
# using CmmD to generate base networks from files containing data extracted from databases
#redes <- paste0('gene_multilayer_network-master/networks/',list.files('gene_multilayer_network-master/networks/'))
#The next line was run in a separate bash terminal, because RStudio doesn't source from bashrc
#com_results <- CmmD::CmmD(input_layers = redes,resolution_start = 0.5,resolution_end = 12,interval = 0.5,distmethod = 'hamming',threads = 7,destfile_community_analysis = 'Com_Out/')
#ham_dist <- read.csv("multilayer/hamming_2022.csv")
ham_dist <- curie_to_12_full$hamming_distance_matrix
ifun <- function(g) {
inx <- c()
for (k in 1:(length(g))) {
inx <- c(inx,which(rownames(ham_dist)==g[k]))
}
return(inx)
}
index.lst <- lapply(g.lst.eid, function(x) ifun(x))
#Making a list of the patients' dataframes
df.lst <- lapply(index.lst, function(x) ham_dist[x,x])
cfun <- function(d,n) {
df.filt <- apply(d, 1, function(x) which(x!=24))
}
df.filt.lst <- lapply(df.lst, cfun)
df.filt.lst2 <- df.filt.lst
#Removing genes that only form communities with themselves
for (m in 1:length(df.filt.lst2)) {
len <- sapply(df.filt.lst[[m]], length)
df.filt.lst2[[m]] <- df.filt.lst[[m]][order(len)]
if (length(df.filt.lst2[[m]][[1]])==1) {
df.filt.lst2[[m]] <- df.filt.lst2[[m]][-(1)]
}
}
post.mn.patients <- lapply(df.filt.lst2, function(x) names(x))
post.mn.patients.matrix <- lapply(post.mn.patients,function(x) as.integer(unique(unlist(post.mn.patients)) %in% x))
post.mn.patients.matrix <- lapply(post.mn.patients.matrix, function(x) as.data.frame(x))
for (i in 1:length(post.mn.patients.matrix)) {
rownames(post.mn.patients.matrix[[i]]) <- unique(unlist(post.mn.patients))
}
post.mn.patients.matrix <- as.data.frame(post.mn.patients.matrix)
colnames(post.mn.patients.matrix) <- c("VM015", "VM024", "VM038", "VM040", "VM042", "VM043",
"VM048", "VM053", "VM054", "VM055", "VM056", "VM060", "VM064",
"VM066", "VM068", "VM071", "VM072", "VM073", "VM081", "VM082",
"VM083", "VM085", "VM089", "VM090", "VM092", "VM093", "VM099",
"VM103", "VM108", "VM110", "VM111", "VM113", "VM119", "VM124",
"VM125", "VM127")
post.mn.patients.matrix <- t(post.mn.patients.matrix)
saveRDS(df.lst, file="sel_hamming_v2")
saveRDS(post.mn.patients, file="filt_genes_per_patient_v2")
#done with the marenostrum
# Create a vector with the paths where Molti's Output files are saved.
structures_12 <- paste0("out_molti/",seq(0,50,1),".csv")
sel.ham.v <- readRDS("../feature_selection/sel_hamming_v2") #table generated in clustering.R, maybe change this to go from pre multi
sel.ham.l <- readRDS("../feature_selection/sel_hamming_l2") #table generated in clustering.R
hamming_com <- curie_to_12_full$hamming_distance_matrix
colnames(hamming_com) <- rownames(hamming_com)
# Load genes associated to each patient from factor selection
tata.v <- lapply(sel.ham.v, function(x) rownames(x))
splited_patients.v <- tata.v
names(splited_patients.v) <- c("VM015", "VM024", "VM038", "VM040", "VM042", "VM043",
"VM048", "VM053", "VM054", "VM055", "VM056", "VM060", "VM064",
"VM066", "VM068", "VM071", "VM072", "VM073", "VM081", "VM082",
"VM083", "VM085", "VM089", "VM090", "VM092", "VM093", "VM099",
"VM103", "VM108", "VM110", "VM111", "VM113", "VM119", "VM124",
"VM125", "VM127")
all_genes_possible.v <- unique(unlist(splited_patients.v,use.names=F))
all_genes_symbol.v <- mapIds(x = org.Hs.eg.db,keys = c(all_genes_possible.v), keytype = 'ENTREZID',column = 'SYMBOL')
# Generate a 0-1 patient x genes matrix that acts as input for pamk, jaccard_ind and hclust.
n_genes_p_patients.v <- matrix(data= 0, nrow= length(splited_patients.v),ncol= length(all_genes_possible.v))
colnames(n_genes_p_patients.v) <- all_genes_possible.v
rownames(n_genes_p_patients.v) <- names(splited_patients.v)
for(rowi in 1:nrow(n_genes_p_patients.v)){
n_genes_p_patients.v[rowi,] <- as.integer(colnames(n_genes_p_patients.v) %in% splited_patients.v[[rowi]])
}
patient_matrix.v <- n_genes_p_patients.v
rownames(patient_matrix.v) <- c("VM015", "VM024", "VM038", "VM040", "VM042", "VM043",
"VM048", "VM053", "VM054", "VM055", "VM056", "VM060", "VM064",
"VM066", "VM068", "VM071", "VM072", "VM073", "VM081", "VM082",
"VM083", "VM085", "VM089", "VM090", "VM092", "VM093", "VM099",
"VM103", "VM108", "VM110", "VM111", "VM113", "VM119", "VM124",
"VM125", "VM127")
# Load genes associated to each patient from factor selection
tata.l <- lapply(sel.ham.l, function(x) rownames(x))
splited_patients.l <- tata.l
names(splited_patients.l) <- c("VM015", "VM024", "VM038", "VM040", "VM042", "VM043",
"VM048", "VM053", "VM054", "VM055", "VM056", "VM060", "VM064",
"VM066", "VM068", "VM071", "VM072", "VM073", "VM081", "VM082",
"VM083", "VM085", "VM089", "VM090", "VM092", "VM093", "VM099",
"VM103", "VM108", "VM110", "VM111", "VM113", "VM119", "VM124",
"VM125", "VM127")
all_genes_possible.l <- unique(unlist(splited_patients.l,use.names=F))
all_genes_symbol.l <- mapIds(x = org.Hs.eg.db,keys = c(all_genes_possible.l), keytype = 'ENTREZID',column = 'SYMBOL')
# Generate a 0-1 patient x genes matrix that acts as input for pamk, jaccard_ind and hclust.
n_genes_p_patients.l <- matrix(data= 0, nrow= length(splited_patients.l),ncol= length(all_genes_possible.l))
colnames(n_genes_p_patients.l) <- all_genes_possible.l
rownames(n_genes_p_patients.l) <- names(splited_patients.l)
for(rowi in 1:nrow(n_genes_p_patients.l)){
n_genes_p_patients.l[rowi,] <- as.integer(colnames(n_genes_p_patients.l) %in% splited_patients.l[[rowi]])
}
patient_matrix.l <- n_genes_p_patients.l
rownames(patient_matrix.l) <- c("VM015", "VM024", "VM038", "VM040", "VM042", "VM043",
"VM048", "VM053", "VM054", "VM055", "VM056", "VM060", "VM064",
"VM066", "VM068", "VM071", "VM072", "VM073", "VM081", "VM082",
"VM083", "VM085", "VM089", "VM090", "VM092", "VM093", "VM099",
"VM103", "VM108", "VM110", "VM111", "VM113", "VM119", "VM124",
"VM125", "VM127")
v_known <- c("VM015", "VM040", "VM042", "VM043", "VM048", "VM053", "VM056", "VM060",
"VM064", "VM066", "VM073", "VM083", "VM099", "VM108", "VM110", "VM111",
"VM113", "VM127")
l_known <- c("VM024", "VM038", "VM071", "VM072")
others <- c("VM119",
"VM103",
"VM081",
"VM093",
"VM090",
"VM124",
"VM082",
"VM055",
"VM068",
"VM085",
"VM089",
"VM125",
"VM092",
"VM054"
)
other.con <- c("strange case",
"capillary malformation",
"capillary malformation",
"eccrine angiomatous hamartoma",
"FAVA: lymphatic component",
"FAVA: lymphatic component",
"glomuvenous malformation",
"infantile hemangioma",
"infantile hemangioma",
"venolymphatic malformation",
"venolymphatic malformation",
"venolymphatic malformation",
"venous malformation/hemangioma?",
"venous malformation: hiperplasia"
)
conditions <- c(rep("venous malformation",length(v_known)),other.con,rep("lymphatic malformation",length(l_known)))
names(conditions) <- c(v_known,others,l_known)
conditions <- conditions[order(names(conditions))]
genes_per_patient_list.l <- list()
genes_per_patient_list.v <- list()
for(k in 0:10){
genes_per_patient.v <- list(splited_patients.v)
for(i in 1:length(splited_patients.v)){
genes_interesantes.v <- names(which(table(splited_patients.v[[i]])>=1))
# Filter genes to those included in the multilayer network.
genes_interesantes.v <- genes_interesantes.v[genes_interesantes.v %in% rownames(hamming_com)]
matricin.v <- hamming_com[genes_interesantes.v,genes_interesantes.v]
# For each value of theta between 0 and 10, we create a vector (suc), where for each gene of the multilayer we calculate the
# number of other multilayer genes that are below a maximum k value of theta -distance in the tree-.
names_matricin.v <- colnames(matricin.v)
suc.v <- vector("numeric",length = length(names_matricin.v))
names(suc.v) <- names_matricin.v
for(j in 1:ncol(matricin.v)){
leng_matricin.v <- length(matricin.v[,j][matricin.v[,j]<=k]) ### k (in our case, a representation of theta) is maximum distance allowed in the clustering plot. (Sauron's eye)
suc.v[j] <- leng_matricin.v
}
suc.v <- suc.v[suc.v>1] ###Filetr genes that have no patient associated partners
genes_per_patient.v[[i]] <- suc.v - 1 ### As a value of 2 mean that only there is one more gene with the gene being analyzed, we substract 1.
}
names(genes_per_patient.v) <- names(splited_patients.v)
genes_per_patient_list.v[[k+1]] <- genes_per_patient.v
names(genes_per_patient_list.v)[[k+1]] <- as.character(k)
message(paste0("theta= ",k))
}
for(k in 0:10){
genes_per_patient.l <- list(splited_patients.l)
for(i in 1:length(splited_patients.l)){
genes_interesantes.l <- names(which(table(splited_patients.l[[i]])>=1))
# Filter genes to those included in the multilayer network.
genes_interesantes.l <- genes_interesantes.l[genes_interesantes.l %in% rownames(hamming_com)]
matricin.l <- hamming_com[genes_interesantes.v,genes_interesantes.l]
# For each value of theta between 0 and 10, we create a vector (suc), where for each gene of the multilayer we calculate the
# number of other multilayer genes that are below a maximum k value of theta -distance in the tree-.
names_matricin.l <- colnames(matricin.l)
suc.l <- vector("numeric",length = length(names_matricin.l))
names(suc.l) <- names_matricin.l
for(j in 1:ncol(matricin.l)){
leng_matricin.l <- length(matricin.l[,j][matricin.l[,j]<=k]) ### k (in our case, a representation of theta) is maximum distance allowed in the clustering plot. (Sauron's eye)
suc.l[j] <- leng_matricin.l
}
suc.l <- suc.l[suc.l>1] ###Filter genes that have no patient associated partners
genes_per_patient.l[[i]] <- suc.l - 1 ### As a value of 2 mean that only there is one more gene with the gene being analyzed, we substract 1.
}
names(genes_per_patient.l) <- names(splited_patients.l)
genes_per_patient_list.l[[k+1]] <- genes_per_patient.l
names(genes_per_patient_list.l)[[k+1]] <- as.character(k)
message(paste0("theta= ",k))
}
names(genes_per_patient.l) <- paste0(names(genes_per_patient.l), ".l")
names(genes_per_patient.v) <- paste0(names(genes_per_patient.v), ".v")
v.and.l <- c(genes_per_patient.v, genes_per_patient.l)
union.lst <- list(seq(1,36))
for (j in 1:(length(v.and.l)/2)) {
union.lst[[j]] <- union(names(v.and.l[[j+36]]), names(v.and.l[[j]]))
}
names(union.lst) <- rownames(patient_matrix.l)
pct.v <- c()
pct.l <- c()
for (e in 1:length(names(union.lst))) {
pct.v[e] <- length(genes_per_patient.v[[e]])/length(union.lst[[e]])
pct.l[e] <- length(genes_per_patient.l[[e]])/length(union.lst[[e]])
}
names(pct.v) <- rownames(patient_matrix.l)
names(pct.l) <- rownames(patient_matrix.l)
pct.v <- pct.v[order(names(pct.v))]
pct.l <- pct.l[order(names(pct.l))]
conditions <- conditions[order(names(conditions))]
df <- data.frame(pct.v,pct.l,conditions)
df$conditions <- as.factor(df$conditions)
df$conditions_new <- as.numeric(df$conditions)
palette(brewer.pal(n = 11, name = "Paired"))
library(RColorBrewer)
palette(brewer.pal(n = 11, name = "Paired"))
plot(df$pct.l, df$pct.v, type="p",pch=19,axes=T,xlab="percentage lymphatic",ylab="percentage venous", col=df$conditions_new)
text(df$pct.l, df$pct.v, rownames(df),xpd=T, pos=2,cex=0.7, offset=0.5)
abline(h=0.6)
abline(v=0.55)
legend("bottomleft",legend=unique(df$conditions),cex=0.7,fill=unique(df$conditions_new),bty = "n",y.intersp=0.6)
abline(h=0.55)
abline(v=0.50)
plot(df$pct.l, df$pct.v, type="p",pch=19,axes=T,xlab="percentage lymphatic",ylab="percentage venous", col=df$conditions_new)
text(df$pct.l, df$pct.v, rownames(df),xpd=T, pos=2,cex=0.7, offset=0.5)
abline(h=0.55)
abline(v=0.50)
legend("bottomleft",legend=unique(df$conditions),cex=0.7,fill=unique(df$conditions_new),bty = "n",y.intersp=0.6)
abline(v=0.52)
abline(h=0.58)
palette(brewer.pal(n = 11, name = "Paired"))
plot(df$pct.l, df$pct.v, type="p",pch=19,axes=T,xlab="percentage lymphatic",ylab="percentage venous", col=df$conditions_new)
text(df$pct.l, df$pct.v, rownames(df),xpd=T, pos=2,cex=0.7, offset=0.5)
abline(h=0.58)
abline(v=0.52)
legend("bottomleft",legend=unique(df$conditions),cex=0.7,fill=unique(df$conditions_new),bty = "n",y.intersp=0.6)
abline(h=0.50)
plot(df$pct.l, df$pct.v, type="p",pch=19,axes=T,xlab="percentage lymphatic",ylab="percentage venous", col=df$conditions_new)
text(df$pct.l, df$pct.v, rownames(df),xpd=T, pos=2,cex=0.7, offset=0.5)
abline(h=0.50)
abline(v=0.52)
legend("bottomleft",legend=unique(df$conditions),cex=0.7,fill=unique(df$conditions_new),bty = "n",y.intersp=0.6)
abline(v=0.65)
abline(v=0.62)
plot(df$pct.l, df$pct.v, type="p",pch=19,axes=T,xlab="percentage lymphatic",ylab="percentage venous", col=df$conditions_new)
text(df$pct.l, df$pct.v, rownames(df),xpd=T, pos=2,cex=0.7, offset=0.5)
abline(h=0.50)
abline(v=0.62)
legend("bottomleft",legend=unique(df$conditions),cex=0.7,fill=unique(df$conditions_new),bty = "n",y.intersp=0.6)
#See how the patients separate based on mutation
other.mut <- c("TEK",
"PIK3CA",
"PTEN",
"TEK",
"PIK3CA",
"nd",
"nd",
"TEK",
"nd",
"nd",
"nd",
"nd",
"PIK3CA",
"TEK",
"nd",
"nd",
"PIK3CA",
"PIK3CA",
"nd",
"nd",
"nd",
"nd",
"PIK3CA",
"PIK3CA",
"nd",
"nd",
"TEK",
"nd",
"TEK",
"PIK3CA",
"TEK",
"TEK",
"nd",
"PIK3CA",
"PIK3CA",
"nd"
)
df$mutation <- as.factor(other.mut)
df$mutations_new <- as.numeric(df$mutation)
palette(brewer.pal(n = 4, name = "Set2"))
plot(df$pct.l, df$pct.v, type="p",pch=19,axes=T,xlab="percentage lymphatic",ylab="percentage venous", col=df$mutations_new)
text(df$pct.l, df$pct.v, rownames(df),xpd=T, pos=2,cex=0.7, offset=0.5)
abline(h=0.50)
abline(v=0.62)
legend("bottomleft",legend=unique(df$mutation),cex=0.7,fill=unique(df$mutations_new),bty = "n",y.intersp=0.6)
other.var <- c(
"L914F",
"E545K",
"Arg14GlufsX29",
"T1105N:G1115Ter",
"E542K",
"nd",
"nd",
"T1105N:T1106P",
"nd",
"nd",
"nd",
"nd",
"H1047R",
"L914F",
"nd",
"nd",
"E545K",
"E542K",
"nd",
"nd",
"nd",
"nd",
"E542K",
"E545G",
"nd",
"nd",
"L914F",
"nd",
"L914F",
"Q546R",
"L914F",
"R1099Ter",
"nd",
"E545K",
"H1047R",
"nd"
)
df$variant <- as.factor(other.var)
df$variant_new <- as.numeric(df$variant)
palette(brewer.pal(n = 11, name = "Paired"))
plot(df$pct.l, df$pct.v, type="p",pch=19,axes=T,xlab="percentage lymphatic",ylab="percentage venous", col=df$variant_new)
text(df$pct.l, df$pct.v, rownames(df),xpd=T, pos=2,cex=0.7, offset=0.5)
abline(h=0.50)
abline(v=0.62)
legend("bottomleft",legend=unique(df$variant),cex=0.7,fill=unique(df$variant_new),bty = "n",y.intersp=0.6)
